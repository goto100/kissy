/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Aug 13 18:48
*/
KISSY.add("date/picker/picker-tpl",'<div class="{{getBaseCssClasses \'header\'}}">\n    <a id="ks-date-picker-previous-month-btn-{{id}}"\n       class="{{getBaseCssClasses \'prev-month-btn\'}}"\n       href="#"\n       role="button"\n       title="{{previousMonthLabel}}"\n       hidefocus="on">\n    </a>\n\n    <a class="{{getBaseCssClasses \'month-select\'}}"\n       role="button"\n       href="#"\n       hidefocus="on"\n       title="{{monthSelectLabel}}"\n       id="ks-date-picker-select-panel-{{id}}">\n        <span id="ks-date-picker-month-select-content-{{id}}">{{monthYearLabel}}</span>\n        <span class="{{getBaseCssClasses \'month-select-arrow\'}}">x</span>\n    </a>\n\n    <a id="ks-date-picker-next-month-btn-{{id}}"\n       class="{{getBaseCssClasses \'next-month-btn\'}}"\n       href="#"\n       role="button"\n       title="{{nextMonthLabel}}"\n       hidefocus="on">\n    </a>\n</div>\n<div class="{{getBaseCssClasses \'body\'}}">\n    <table class="{{getBaseCssClasses \'table\'}}" cellspacing="0" role="grid">\n        <thead>\n        <tr role="row">\n            {{#each weekdays}}\n            <th role="columnheader" title="{{.}}" class="{{getBaseCssClasses \'column-header\'}}">\n                <span class="{{getBaseCssClasses \'column-header-inner\'}}">\n                    {{veryShortWeekdays[xindex]}}\n                </span>\n            </th>\n            {{/each}}\n        </tr>\n        </thead>\n        <tbody id="ks-date-picker-tbody-{{id}}">\n        {{{renderDates}}}\n        </tbody>\n    </table>\n</div>\n{{#if showToday}}\n<div class="{{getBaseCssClasses \'footer\'}}">\n    <a class="{{getBaseCssClasses \'today-btn\'}}"\n       role="button"\n       hidefocus="on"\n       href="#"\n       id="ks-date-picker-today-btn-{{id}}"\n       title="{{todayTimeLabel}}">{{todayLabel}}</a>\n</div>\n{{/if}}');
KISSY.add("date/picker/render",function(i,k,b,p,n){function q(a,d){return a.get(b.YEAR)==d.get(b.YEAR)&&a.get(b.MONTH)==d.get(b.MONTH)&&a.get(b.DAY_OF_MONTH)==d.get(b.DAY_OF_MONTH)}return k.getDefaultRender().extend({getMonthYearLabel:function(){var a=this.control,d=a.get("locale"),a=a.get("value"),b=a.getLocale();return(new p(d.monthYearFormat,b)).format(a)},getTodayTimeLabel:function(){var a=this.control,b=a.get("locale"),f=a.get("value"),a=f.getLocale(),f=f.clone();f.setTimeInMillis(i.now());return(new p(b.dateFormat,
a)).format(f)},beforeCreateDom:function(a,b,f){var c=this.control,g=c.get("locale"),j=c.get("value"),c=j.getLocale();i.mix(b,{previousMonthBtn:"#ks-date-picker-previous-month-btn-{id}",monthSelectEl:"#ks-date-picker-month-select-{id}",monthSelectContentEl:"#ks-date-picker-month-select-content-{id}",nextMonthBtn:"#ks-date-picker-next-month-btn-{id}",todayBtnEl:"#ks-date-picker-today-btn-{id}",tbodyEl:"#ks-date-picker-tbody-{id}"});for(var b=[],e=[],j=j.getFirstDayOfWeek(),l=0;7>l;l++){var r=(j+l)%
7;b[l]=g.veryShortWeekdays[r];e[l]=c.weekdays[r]}i.mix(a,{monthYearLabel:this.getMonthYearLabel(),previousMonthLabel:g.previousMonth,monthSelectLabel:g.monthSelect,nextMonthLabel:g.nextMonth,weekdays:e,veryShortWeekdays:b,todayLabel:g.today,todayTimeLabel:this.getTodayTimeLabel()});f.renderDates=i.bind(this.renderDates,this)},renderDates:function(){var a,d,f=[],c,g=this.control,j=g.get("locale"),e=g.get("value"),l=e.clone(),r=this.getBaseCssClass("cell"),k=this.getBaseCssClass("date"),n=g.get("dateRender"),
u=g.get("disabledDate"),s=e.getLocale(),j=new p(j.dateFormat,s),s=this.getBaseCssClass("today"),v=this.getBaseCssClass("selected-day"),w=this.getBaseCssClass("last-month-cell"),x=this.getBaseCssClass("next-month-btn-day"),y=this.getBaseCssClass("disabled-cell");l.setTimeInMillis(i.now());d=e.clone();d.set(e.get(b.YEAR),e.get(b.MONTH),1);a=(d.get(b.DAY_OF_WEEK)+7-e.getFirstDayOfWeek())%7;var o=d.clone();o.add(b.DAY_OF_MONTH,-a);var m=0;for(a=0;6>a;a++){f[a]=[];for(d=0;7>d;d++)c=o,m&&(c=c.clone(),c.add(b.DAY_OF_MONTH,
m)),f[a][d]=c,m++}o="";for(a=0;6>a;a++){m='<tr role="row">';for(d=0;7>d;d++){c=f[a][d];var h=r;q(c,l)&&(h+=" "+s);q(c,e)&&(h+=" "+v);(c.get(b.YEAR)<e.get(b.YEAR)||c.get(b.YEAR)==e.get(b.YEAR)&&c.get(b.MONTH)<e.get(b.MONTH))&&(h+=" "+w);(c.get(b.YEAR)>e.get(b.YEAR)||c.get(b.YEAR)==e.get(b.YEAR)&&c.get(b.MONTH)>e.get(b.MONTH))&&(h+=" "+x);u&&u(c,e)&&(h+=" "+y);var t="";if(!n||!(t=n(c,e)))t=i.substitute('<a hidefocus="on" class="{cls}" href="#">{content}</a>',{cls:k,content:c.get(b.DAY_OF_MONTH)});m+=
i.substitute('<td role="gridcell" title="{title}" class="{cls}">{content}</td>',{cls:h,title:j.format(c),content:t})}o+=m+"</tr>"}g.dateTable=f;return o},_onSetValue:function(){var a=this.control,b=a.get("tbodyEl"),f=a.get("monthSelectContentEl"),a=a.get("todayBtnEl");f.html(this.getMonthYearLabel());a.attr("title",this.getTodayTimeLabel());b.html(this.renderDates())}},{name:"date-picker-render",ATTRS:{contentTpl:{value:n}}})},{requires:["component/control","date/gregorian","date/format","./picker-tpl"]});
KISSY.add("date/picker/control",function(i,k,b,p,n,q){function a(a,c){var d=a.get("value").clone();d.add(b.MONTH,c);a.set("value",d)}function d(b){b.preventDefault();a(this,1)}function f(b){b.preventDefault();a(this,-1)}function c(b){b.preventDefault();var a=j(b.currentTarget);a.hasClass(this.view.getBaseCssClass("disabled-cell"))||(b=a.parent(),a=a.index(),this.set("value",this.dateTable[b.index()][a]))}var g=k.Gesture.tap,j=k.all;return n.extend({bindUI:function(){this.get("nextMonthBtn").on(g,
d,this);this.get("previousMonthBtn").on(g,f,this);this.get("tbodyEl").delegate(g,"."+this.view.getBaseCssClass("cell"),c,this)}},{xclass:"date-picker",ATTRS:{value:{view:1,valueFn:function(){var a=new b;a.setTimeInMillis(i.now());return a}},previousMonthBtn:{},monthSelectEl:{},nextMonthBtn:{},tbodyEl:{},todayBtnEl:{},dateRender:{},disabledDate:{},locale:{value:p},showToday:{view:1,value:!0},xrender:{value:q}}})},{requires:["node","date/gregorian","i18n!date/picker","component/control","./render"]});
KISSY.add("date/picker",function(i,k){return k},{requires:["./picker/control"]});
