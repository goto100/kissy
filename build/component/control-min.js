/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Aug 13 18:47
*/
KISSY.add("component/control/process",function(b,g,e){function l(b){b.fire("beforeSyncUI");b.syncUI();b.__callPluginsMethod("pluginSyncUI");b.fire("afterSyncUI")}var i=e.Defer,e=g.prototype.__getHook,b=b.noop,j=g.extend({bindInternal:b,syncInternal:b,initializer:function(){this._renderedDefer=new i},createDom:b,renderUI:b,bindUI:b,syncUI:b,onRendered:function(b){return this._renderedDefer.promise.then(b)},create:function(){this.get("created")||(this.fire("beforeCreateDom"),this.createInternal(),this.__callPluginsMethod("pluginCreateDom"),
this.fire("afterCreateDom"),this.setInternal("created",!0));return this},createInternal:function(){this.createDom()},render:function(){this.get("rendered")||(this.create(),this.fire("beforeRenderUI"),this.renderUI(),this.__callPluginsMethod("pluginRenderUI"),this.fire("afterRenderUI"),this.fire("beforeBindUI"),j.superclass.bindInternal.call(this),this.bindUI(),this.__callPluginsMethod("pluginBindUI"),this.fire("afterBindUI"),j.superclass.syncInternal.call(this),l(this),this.setInternal("rendered",
!0));return this},sync:function(){l(this)},plug:function(b){var g=this.get("plugins");this.callSuper(b);b=g[g.length-1];this.get("rendered")?(b.pluginCreateDom&&b.pluginCreateDom(this),b.pluginRenderUI&&b.pluginRenderUI(this),b.pluginBindUI&&b.pluginBindUI(this),b.pluginSyncUI&&b.pluginSyncUI(this)):this.get("created")&&b.pluginCreateDom&&b.pluginCreateDom(this);return this}},{__hooks__:{createDom:e("__createDom"),renderUI:e("__renderUI"),bindUI:e("__bindUI"),syncUI:e("__syncUI")},name:"ComponentProcess",
ATTRS:{rendered:{value:!1,setter:function(b){b&&this._renderedDefer.resolve(this)}},created:{value:!1}}});return j},{requires:["base","promise"]});KISSY.add("component/control/render-tpl",'<div id="{{id}}"\n class="{{getBaseCssClasses ""}}\n{{#each elCls}}\n {{.}}  \n{{/each}}\n"\n\n{{#each elAttrs}} \n {{xkey}}="{{.}}"  \n{{/each}}\n\nstyle="\n{{#each elStyle}} \n {{xkey}}:{{.}};  \n{{/each}}\n">');
KISSY.add("component/control/render",function(b,g,e,l,i){function j(c){"number"==typeof c&&(c+="px");return c}function p(c){c||(c=[""]);"string"==typeof c&&(c=c.split(/\s+/));return c}function q(c,a,b){for(var d="",f=0,r=b.length,a=c+a;f<r;f++)c=(c=b[f])?"-"+c:c,d+=" "+a+c;return d}function n(c){var a;c.target==this.control&&(a=this[d+c.type.slice(5).slice(0,-6)],a.call(this,c.newVal,c))}function s(c,a){return this.getBaseCssClasses(a.params[0])}function a(c,a){return this.getBaseCssClass(a.params[0])}
var d="_onSet",t=b.trim,v=b.all,u=b.UA,h=b.Env.host.document;return g.extend({isRender:!0,createInternal:function(){var c=this.control.get("srcNode");c?this.decorateDom(c):this.callSuper()},beforeCreateDom:function(c){var a=this.control,b,d,f,r=a.get("elAttrs"),g=a.get("elCls"),e;b=a.getAttrs();e=a.get("elStyle");var h=a.get("elCls");for(d in b)f=b[d],f.view&&(c[d]=a.get(d));b=c.width;d=c.height;f=c.visible;c=c.zIndex;b&&(e.width=j(b));d&&(e.height=j(d));c&&(e["z-index"]=c);f||h.push(this.getBaseCssClasses("hidden"));
if(e=a.get("disabled"))g.push(this.getBaseCssClasses("disabled")),r["aria-disabled"]="true";a.get("highlighted")&&g.push(this.getBaseCssClasses("hover"));a.get("focusable")&&(u.ie&&(r.hideFocus="true"),r.tabindex=e?"-1":"0")},createDom:function(){this.beforeCreateDom(this.renderData={},this.childrenElSelectors={},this.renderCommands={getBaseCssClasses:b.bind(s,this),getBaseCssClass:b.bind(a,this)});var c=this.control,k;k=this.renderTpl(l+this.get("contentTpl")+"</div>");c.setInternal("el",this.$el=
v(k));this.el=this.$el[0];this.fillChildrenElsBySelectors()},decorateDom:function(c){var a=this.control;c.attr("id")||c.attr("id",a.get("id"));var d=this.constructor.HTML_PARSER,m,f;for(m in d)f=d[m],"function"===typeof f?(f=f.call(this,c),void 0!==f&&a.setInternal(m,f)):"string"==typeof f?a.setInternal(m,c.one(f)):b.isArray(f)&&f[0]&&a.setInternal(m,c.all(f[0]));a.setInternal("el",this.$el=c);this.el=c[0]},renderUI:function(){var c=this.control,a=this.$el;if(!c.get("srcNode")){var b=c.get("render");
(c=c.get("elBefore"))?a.insertBefore(c,void 0):b?a.appendTo(b,void 0):a.appendTo(h.body,void 0)}},bindUI:function(){var a=this.control,k=a.getAttrs(),o,m;for(o in k){m=k[o];var f=b.ucfirst(o),e=this[d+f];if(m.view&&e)a.on("after"+f+"Change",n,this)}},destructor:function(){this.$el&&this.$el.remove()},$:function(a){return this.$el.all(a)},fillChildrenElsBySelectors:function(a){var d=this.$el,o=this.control,e,f,a=a||this.childrenElSelectors;for(e in a)f=a[e],"function"===typeof f?o.setInternal(e,f(d)):
o.setInternal(e,this.$(b.substitute(f,this.renderData))),delete a[e]},renderTpl:function(a,b,d){b=b||this.renderData;d=d||this.renderCommands;return(new e(a,{commands:d})).render(b)},getComponentConstructorByNode:function(a,b){var d=b[0].className;return d?(d=d.replace(RegExp("\\b"+a,"ig"),""),i.getConstructorByXClass(d)):null},getComponentCssClasses:function(){if(this.componentCssClasses)return this.componentCssClasses;for(var a=this.control.constructor,b,d=[];a&&!a.prototype.hasOwnProperty("isControl");)(b=
a.xclass)&&d.push(b),a=a.superclass&&a.superclass.constructor;return this.componentCssClasses=d},getBaseCssClasses:function(a){for(var a=p(a),b=this.getComponentCssClasses(),d=0,e=this.get("control"),f="",g=b.length,e=e.get("prefixCls");d<g;d++)f+=q(e,b[d],a);return t(f)},getBaseCssClass:function(a){return t(q(this.control.get("prefixCls"),this.getComponentCssClasses()[0],p(a)))},getKeyEventTarget:function(){return this.$el},_onSetWidth:function(a){this.$el.width(a)},_onSetHeight:function(a){this.$el.height(a)},
_onSetContent:function(a){var b=this.$el;b.html(a);9>u.ie&&!this.get("allowTextSelection")&&b.unselectable()},_onSetVisible:function(a){var b=this.$el,d=this.getBaseCssClasses("hidden");a?b.removeClass(d):b.addClass(d)},_onSetHighlighted:function(a){var b=this.getBaseCssClasses("hover");this.$el[a?"addClass":"removeClass"](b)},_onSetDisabled:function(a){var b=this.control,d=this.getBaseCssClasses("disabled");this.$el[a?"addClass":"removeClass"](d).attr("aria-disabled",a);b.get("focusable")&&this.getKeyEventTarget().attr("tabindex",
a?-1:0)},_onSetActive:function(a){var b=this.getBaseCssClasses("active");this.$el[a?"addClass":"removeClass"](b).attr("aria-pressed",!!a)},_onSetFocused:function(a){var b=this.$el,d=this.getBaseCssClasses("focused");b[a?"addClass":"removeClass"](d)},_onSetZIndex:function(a){this.$el.css("z-index",a)}},{__hooks__:{decorateDom:g.prototype.__getHook("__decorateDom"),beforeCreateDom:g.prototype.__getHook("__beforeCreateDom")},extend:function k(a,d,f){var e,h={};e=g.extend.apply(this,arguments);e.HTML_PARSER=
e.HTML_PARSER||{};b.isArray(a)&&(b.each(a.concat(e),function(a){a&&b.each(a.HTML_PARSER,function(a,b){h[b]=a})}),e.HTML_PARSER=h);b.mix(e.HTML_PARSER,this.HTML_PARSER,!1);e.extend=k;return e},ATTRS:{control:{setter:function(a){this.control=a}},contentTpl:{value:"{{{content}}}"}},HTML_PARSER:{id:function(a){return(a=a[0].id)?a:void 0},content:function(a){return a.html()},disabled:function(a){return a.hasClass(this.getBaseCssClass("disabled"))}},name:"render"})},{requires:["./process","xtemplate","./render-tpl",
"component/manager"]});
KISSY.add("component/control",function(b,g,e,l,i,j){function p(){var a,b=this;do a=b.ATTRS,b=b.superclass;while(!a||!a.xrender);return a.xrender.value}var q=b.Env.host.document.documentMode||b.UA.ie,n=g.Gesture,s=b.Features.isTouchEventSupported(),i=e.extend({isControl:!0,createDom:function(){var a=this.get("xrender"),b=this.get("view"),e=this.get("id");b?b.set("control",this):this.set("view",this.view=b=new a({control:this}));b.create();a=b.getKeyEventTarget();this.get("allowTextSelection")||a.unselectable();
l.addComponent(e,this)},renderUI:function(){this.view.render()},bindUI:function(){var a=this.view.getKeyEventTarget();if(this.get("focusable"))a.on("focus",this.handleFocus,this).on("blur",this.handleBlur,this).on("keydown",this.handleKeydown,this);if(this.get("handleMouseEvents")){a=this.$el;if(!s)a.on("mouseenter",this.handleMouseEnter,this).on("mouseleave",this.handleMouseLeave,this).on("contextmenu",this.handleContextMenu,this);a.on(n.start,this.handleMouseDown,this).on(n.end,this.handleMouseUp,
this).on(n.tap,this.handleClick,this);if(n.cancel)a.on(n.cancel,this.handleMouseUp,this);if(q&&9>q)a.on("dblclick",this.handleDblClick,this)}},sync:function(){this.fire("beforeSyncUI");this.syncUI();this.view.sync();this.__callPluginsMethod("pluginSyncUI");this.fire("afterSyncUI")},createComponent:function(a,b){return l.createComponent(a,b||this)},_onSetFocused:function(a){var b=this.view.getKeyEventTarget()[0];a?b.focus():b.ownerDocument.activeElement==b&&b.ownerDocument.body.focus()},_onSetX:function(a){this.$el.offset({left:a})},
_onSetY:function(a){this.$el.offset({top:a})},_onSetVisible:function(a){this.fire(a?"show":"hide")},show:function(){this.render();this.set("visible",!0);return this},hide:function(){this.set("visible",!1);return this},focus:function(){this.get("focusable")&&this.set("focused",!0)},blur:function(){this.get("focusable")&&this.set("focused",!1)},move:function(a,b){this.set({x:a,y:b})},handleDblClick:function(a){this.get("disabled")||this.handleDblClickInternal(a)},handleDblClickInternal:function(a){this.handleClickInternal(a)},
handleMouseEnter:function(a){this.get("disabled")||this.handleMouseEnterInternal(a)},handleMouseEnterInternal:function(a){this.set("highlighted",!!a)},handleMouseLeave:function(a){this.get("disabled")||this.handleMouseLeaveInternal(a)},handleMouseLeaveInternal:function(a){this.set("active",!1);this.set("highlighted",!a)},handleMouseDown:function(a){this.get("disabled")||this.handleMouseDownInternal(a)},handleMouseDownInternal:function(a){var b;if(1==a.which||s)this.get("activeable")&&this.set("active",
!0),this.get("focusable")&&this.focus(),this.get("allowTextSelection")||(b=(b=a.target.nodeName)&&b.toLowerCase(),"input"!=b&&"textarea"!=b&&a.preventDefault())},handleMouseUp:function(a){this.get("disabled")||this.handleMouseUpInternal(a)},handleMouseUpInternal:function(a){this.get("active")&&(1==a.which||s)&&this.set("active",!1)},handleContextMenu:function(a){this.get("disabled")||this.handleContextMenuInternal(a)},handleContextMenuInternal:function(){},handleFocus:function(){this.get("disabled")||
this.handleFocusInternal()},handleFocusInternal:function(){this.focus();this.fire("focus")},handleBlur:function(){this.get("disabled")||this.handleBlurInternal()},handleBlurInternal:function(){this.blur();this.fire("blur")},handleKeydown:function(a){return!this.get("disabled")&&this.handleKeyDownInternal(a)?(a.halt(),!0):j},handleKeyDownInternal:function(a){return a.keyCode==g.KeyCode.ENTER?this.handleClickInternal(a):j},handleClick:function(a){this.get("disabled")||this.handleClickInternal(a)},handleClickInternal:function(){},
destructor:function(){l.removeComponent(this.get("id"));this.view&&this.view.destroy()}},{name:"control",ATTRS:{id:{view:1,valueFn:function(){return b.guid("ks-component")}},content:{view:1,value:""},width:{view:1},height:{view:1},elCls:{view:1,value:[],setter:function(a){"string"==typeof a&&(a=a.split(/\s+/));return a||[]}},elStyle:{view:1,value:{}},elAttrs:{view:1,value:{}},elBefore:{},el:{setter:function(a){this.$el=a;this.el=a[0]}},x:{},y:{},xy:{setter:function(a){var d=b.makeArray(a);d.length&&
(d[0]&&this.set("x",d[0]),d[1]&&this.set("y",d[1]));return a},getter:function(){return[this.get("x"),this.get("y")]}},zIndex:{view:1},render:{},visible:{sync:0,value:!0,view:1},srcNode:{setter:function(a){return g.all(a)}},handleMouseEvents:{value:!0},focusable:{value:!0,view:1},allowTextSelection:{value:!1},activeable:{value:!0},focused:{view:1},active:{view:1,value:!1},highlighted:{view:1,value:!1},prefixCls:{view:1,value:b.config("component/prefixCls")||"ks-"},prefixXClass:{},parent:{setter:function(a,
b){(b=this.get("parent"))&&this.removeTarget(b);a&&this.addTarget(a)}},disabled:{view:1,value:!1},xrender:{value:i},view:{setter:function(a){this.view=a}}}});i.getDefaultRender=p;i.extend=function d(g,i,j){var h=b.makeArray(arguments),c,k=h[h.length-1];if(c=k.xclass)k.name=c;h=e.extend.apply(this,h);c&&l.setConstructorByXClass(c,h);h.extend=d;h.getDefaultRender=p;return h};return i},{requires:["node","./control/process","component/manager","./control/render"]});
